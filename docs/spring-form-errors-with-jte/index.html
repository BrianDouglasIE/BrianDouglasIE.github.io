<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

    <!-- Meta Description -->
    <meta name="description" content="Handle Spring form errors with JTE"/>

    <!-- Keywords -->
    <meta name="keywords" content="Brian Douglas, blog, java,spring"/>

    <!-- Author -->
    <meta name="author" content="Brian Douglas"/>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="BrianDouglas.ie - Handle Spring form errors with JTE"/>
    <meta property="og:description" content="Handle Spring form errors with JTE"/>
    <meta property="og:url" content="https://www.briandouglas.ie"/>
    <meta property="og:image" content="http://www.briandouglas.ie/images/og-images/spring-form-errors-with-jte.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1280"/>
    <meta property="og:image:height" content="640"/>
    <meta property="og:site_name" content="BrianDouglas.ie"/>
    <meta property="og:image:alt" content="A preview image for the post titled 'Handle Spring form errors with JTE'"/>

    <!-- Twitter Meta -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BrianDouglasIE"/>
    <meta name="twitter:title" content="BrianDouglas.ie - Handle Spring form errors with JTE"/>
    <meta name="twitter:description" content="Handle Spring form errors with JTE"/>
    <meta name="twitter:image" content="http://www.briandouglas.ie/images/og-images/spring-form-errors-with-jte.png"/>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.briandouglas.ie"/>

    <!-- Favicon (Optional) -->
    <link rel="icon" href="https://www.briandouglas.ie/favicon.ico" type="image/x-icon"/>

    <!-- Robots -->
    <meta name="robots" content="index, follow"/>

    <!-- Favicon-->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
    <link rel="manifest" href="/site.webmanifest"/>

    <title>Handle Spring form errors with JTE</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

<div class="content">
    <header class="site-header">
    <a href="/" class="home">Brian Douglas</a>

    <a href="https://github.com/BrianDouglasIE" class="github">
        <svg
                height="32"
                aria-hidden="true"
                viewBox="0 0 24 24"
                width="32"
                data-view-component="true"
        >
            <path
                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"
            ></path>
        </svg>
    </a>
</header>
    <div class="breadcrumbs">
        <a href="/">Home</a> / <span>Handle Spring form errors with JTE</span>
    </div>

    <main>
        <article class="post">
            <header>
                <h1>Handle Spring form errors with JTE</h1>
                <time datetime="17/06/2025">June 17th, 2025</time>
            </header>

            <div class="body">
                <p>I've been working with JTE (Java Template Engine) templates in my latest Spring app. They are a joy to work with and
feel like a more <em>modern</em> alternative to Thymeleaf templates. With Spring however there are some integrations that a
Thymeleaf user would expect, that are missing when using JTE. Automatic form error association being one. So I have
documented how to pass form errors to your jte templates below.</p>
<!-- more -->
<h2 id="theproblem">The problem</h2>
<p>Let's say we have a <code>RegistrationForm</code> class, that has various validator annotations. When one of these validators fails
we expect the <code>RegistrationController</code> to return the registration form view with the errors present, such as the below
example.</p>
<pre><code class="java language-java">@Controller
@AllArgsConstructor
@RequestMapping("/register")
public class RegistrationController {

    private static final String FORM_VIEW = "auth/register";
    private static final String ATTR_PAGE = "page";

    @GetMapping
    public String showRegisterForm(Model model) {
        model.addAttribute(ATTR_PAGE, new Page("Register"));
        model.addAttribute(ATTR_REGISTRATION_FORM, new RegistrationForm());
        return FORM_VIEW;
    }

    @PostMapping
    public String processRegisterForm(@ModelAttribute @Validated RegistrationForm registrationForm,
                                      BindingResult result,
                                      Model model) {

        model.addAttribute(ATTR_PAGE, new Page("Register"));
        model.addAttribute(ATTR_REGISTRATION_FORM, registrationForm);

        if (result.hasErrors()) {
            return FORM_VIEW;
        }

        // ...
    }
}
</code></pre>
<p>In the above example, when the <code>BindingResult</code> has errors the user is taken back to the registration form page. If we
were using Thymeleaf, the validation errors would be auto attached to the view and can be rendered with special syntax.</p>
<p><magpie-trinket>You can read more about how Thymeleaf handles form errors
at <a href="https://www.baeldung.com/spring-thymeleaf-error-messages">spring-thymeleaf-error-messages</a></magpie-trinket></p>
<p>Jte does not support this type of integration. This is a good thing, as it allows the developer to handle the form field
validation how they see fit. Before I go into how I bind the form errors via the controller, here is the
<code>RegistrationForm</code> class.</p>
<pre><code class="java language-java">@Getter
@Setter
public class RegistrationForm {
    @NotBlank(message = "Email address is required")
    @Email(message = "Invalid email format")
    private String email;

    @NotBlank(message = "Password is required")
    @Size(min = 8, max = 250, message = "Password must be a minimum of 8 characters in length")
    private String password;
    @NotBlank(message = "Confirm password is required")
    private String confirmPassword;

    @NotBlank(message = "First name is required")
    @Size(min = 1, message = "First name must be between 1 and 50 characters in length")
    private String firstName;

    @NotBlank(message = "Last name is required")
    @Size(min = 3, message = "Last name must be between 3 and 50 characters in length")
    private String lastName;
}
</code></pre>
<p>From this you can guess that when there is an email format issue we want to show the appropriate message to our user on
the frontend. Naturally this is the case for all the other fields also. Here is how I render the error message in the
jte template.</p>
<pre><code class="html language-html">@param ValidationHelper validation
@param RegistrationForm registrationForm

@if(validation.hasErrors())
    &lt;div class="form-error"&gt;Please correct the following errors to proceed.&lt;/div&gt;
@endif

&lt;label&gt;Email Address
    &lt;input name="email" type="email" value="${registrationForm.getEmail()}" required&gt;
    @if(validation.hasError("email"))
        &lt;small class="error-text"&gt;${validation.getError("email").getDefaultMessage()}&lt;/small&gt;
    @endif
&lt;/label&gt;
</code></pre>
<p><chicken-asks>But wait! where is the <code>ValidationHelper</code> coming from?</chicken-asks>
<magpie-replies>Eagle eyed again, he shows us how to add it below</magpie-replies></p>
<p>You'll notice that I have added a <code>ValidationHelper</code> param. I will show you how this is implemented below. But as you
can see, we are going to use this to render our form errors. The api should be self-explanatory <code>hasErrors</code>, tells us
if there are any errors present, <code>hasError</code> tells us if a specific error is present, and <code>getError</code> give us the details
of the specific error.</p>
<h2 id="validationhelper">ValidationHelper</h2>
<p>The <code>ValidationHelper</code> class itself is just a wrapper around the <code>BindingResult</code> which we will pass in via the
controller. I've added the <code>@NoArgsConstructor</code> so that is can be instantiated without a <code>BindingResult</code>. The null
checks mean that this is safe to use when a <code>BindingResult</code> is not present.</p>
<pre><code class="java language-java">@NoArgsConstructor
@AllArgsConstructor
public class ValidationHelper {
    private BindingResult bindingResult;

    public boolean hasErrors() {
        return bindingResult != null &amp;&amp; bindingResult.hasErrors();
    }

    public boolean hasError(String name) {
        return bindingResult != null &amp;&amp; bindingResult.hasFieldErrors(name);
    }

    public List&lt;FieldError&gt; getErrors() {
        if (bindingResult == null) {
            return Collections.emptyList();
        } else {
            return bindingResult.getFieldErrors();
        }
    }

    public FieldError getError(String fieldName) {
        if (bindingResult == null) {
            return null;
        } else {
            return bindingResult.getFieldError(fieldName);
        }
    }
}
</code></pre>
<p>The updated <code>RegistrationController</code> is below. The example registration form jte template does not need to be updated.</p>
<pre><code class="java language-java">@Controller
@AllArgsConstructor
@RequestMapping("/register")
public class RegistrationController {

    private static final String FORM_VIEW = "auth/register";
    private static final String ATTR_PAGE = "page";
    private static final String ATTR_VALIDATION = "validation";

    @GetMapping
    public String showRegisterForm(Model model) {
        model.addAttribute(ATTR_PAGE, new Page("Register"));
        model.addAttribute(ATTR_REGISTRATION_FORM, new RegistrationForm());
        model.addAttribute(ATTR_VALIDATION, new ValidationHelper());
        return FORM_VIEW;
    }

    @PostMapping
    public String processRegisterForm(@ModelAttribute @Validated RegistrationForm registrationForm,
                                      BindingResult result,
                                      Model model) {

        model.addAttribute(ATTR_PAGE, new Page("Register"));
        model.addAttribute(ATTR_REGISTRATION_FORM, registrationForm);
        model.addAttribute(ATTR_VALIDATION, new ValidationHelper(result));

        if (result.hasErrors()) {
            return FORM_VIEW;
        }

        // ...
    }
}
</code></pre>
            </div>

            <footer>
                <p><i>Until next time,</i></p>
                <p><i>Brian</i></p>
            </footer>
        </article>
    </main>

    <footer class="site-footer">
    <p>
        <small>Since August 4th, 2023. All words by Brian
            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>
    </p>
</footer>

</div>

<script src="/scripts/chicken-and-magpie.js"></script>
<script src="/scripts/skip-to-section.js"></script>
<script src="/scripts/code-highlighter.js"></script>
</body>
</html>
