<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

    <!-- Meta Description -->
    <meta name="description" content="Object field validators in Typescript"/>

    <!-- Keywords -->
    <meta name="keywords" content="Brian Douglas, blog, js"/>

    <!-- Author -->
    <meta name="author" content="Brian Douglas"/>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="BrianDouglas.ie - Object field validators in Typescript"/>
    <meta property="og:description" content="Object field validators in Typescript"/>
    <meta property="og:url" content="https://www.briandouglas.ie"/>
    <meta property="og:image" content="http://www.briandouglas.ie/images/og-images/typescript-field-validators.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1280"/>
    <meta property="og:image:height" content="640"/>
    <meta property="og:site_name" content="BrianDouglas.ie"/>
    <meta property="og:image:alt" content="A preview image for the post titled 'Object field validators in Typescript'"/>

    <!-- Twitter Meta -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BrianDouglasIE"/>
    <meta name="twitter:title" content="BrianDouglas.ie - Object field validators in Typescript"/>
    <meta name="twitter:description" content="Object field validators in Typescript"/>
    <meta name="twitter:image" content="http://www.briandouglas.ie/images/og-images/typescript-field-validators.png"/>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.briandouglas.ie"/>

    <!-- Favicon (Optional) -->
    <link rel="icon" href="https://www.briandouglas.ie/favicon.ico" type="image/x-icon"/>

    <!-- Robots -->
    <meta name="robots" content="index, follow"/>

    <!-- Favicon-->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
    <link rel="manifest" href="/site.webmanifest"/>

    <title>Object field validators in Typescript</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>

<div class="content">
    <header class="site-header">
    <a href="/" class="home">Brian Douglas</a>

    <a href="https://github.com/BrianDouglasIE" class="github">
        <svg
                height="32"
                aria-hidden="true"
                viewBox="0 0 24 24"
                width="32"
                data-view-component="true"
        >
            <path
                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"
            ></path>
        </svg>
    </a>
</header>
    <div class="breadcrumbs">
        <a href="/">Home</a> / <span>Object field validators in Typescript</span>
    </div>

    <main>
        <article class="post">
            <header>
                <h1>Object field validators in Typescript</h1>
                <time datetime="08/08/2025">August 8th, 2025</time>
            </header>

            <div class="body">
                <p>Before you pull in the next hot new validation library. Ask yourself this question. Do I need it?
The answer is no, field validation is quite easy. Let me show you how to create an extensible
object field validator. </p>
<!-- more -->
<h2 id="whatsanobjectfieldvalidator">Whats an object field validator?</h2>
<p>Ok, so let's work with the following scenario. You have a user registration form. It's represented
in your code as the following type.</p>
<pre><code class="typescript language-typescript">type UserForm = { email: string, password: string }
</code></pre>
<p>Typescript will ensure that you get an error message when you try to assign a <code>number</code> instead of
a <code>string</code> for the email field. But this object represents form data, aka user input. So it could
be anything. We should validate that it matches our criteria. For example the email should be of a
valid email format, and the password should be no less that 8 characters in length.</p>
<p>This where an <em>object field validator</em> comes into play. It takes an object and applies the given 
validators to the object fields. Telling us that, <em>yes this user form contains a valid email address</em> 
etcâ€¦</p>
<h2 id="usage">Usage</h2>
<p>Let's start by defining how we want to use it. I'd like to make a composable validator. This would be
a function that takes a generic type and produces a validator for that type. The type in question is
the above <code>UserForm</code>. The method used to compose the validator should take an object that contains a
list of field validators for each of the <code>UserForm</code> fields. These <em>field validators</em> should themselves
be composable methods.</p>
<p>When the composed validator is called with our <code>UserForm</code> instance, it should return an object representing
any errors that were found.</p>
<p>The end result should be a clean api for creating <em>object field validators</em>. To me the below example is perfect.</p>
<pre><code class="typescript language-typescript">type UserForm = { email: string, password: string }

const userFormValidator = createFieldValidator&lt;UserForm&gt;({
  email: [stringValidators.email((email: string) =&gt; `${email} is not a valid email address`)],
  password: [
    stringValidators.min(8, () =&gt; `Password must be greater than 8 characters in length`),
    stringValidators.max(250, () =&gt; `Password must be less than 8 characters in length`),
  ]
})

const validated = userFormValidator({ email: 'not an email', password: '2 short' })
</code></pre>
<p>The <code>validated</code> variable above will hold the following value.</p>
<pre><code>{
  input: {
    email: "not an email",
    password: "2 short",
  },
  errors: {
    email: [ "'not an email' is not a valid email address" ],
    password: [ "Password must be at least 8 characters long" ],
  },
  hasErrors: true,
}
</code></pre>
<p>This makes it easy to check if there are errors present, using the <code>hasErrors</code> field, and then access a list
of error messages for each field.</p>
<h2 id="implementation">Implementation</h2>
<p>I'd like to believe that you are a top programmer and just want to see the code, without me trying to clumsly explain it.
The code doesn't tell lies, I do. So here is the code.</p>
<p><chicken-asks>Why did he need to add <code>&lt;T extends Object&gt;</code>?</chicken-asks>
<magpie-replies>Well <code>Object.entries</code> needs to take an <code>Object</code> or an <code>ArrayLike</code> entity. So it was just to tell the type checker that <code>T</code> is some sort of <code>Object</code>.</magpie-replies></p>
<pre><code class="typescript language-typescript">type ErrorMap = { [key: string]: string[] }
type ErrorMessageCallback = (input: string) =&gt; string
type ValidatorMap = { [key: string]: Function[] }
type Validated&lt;T&gt; = { input: T, errors: ErrorMap, hasErrors: boolean }

export const createFieldValidator = &lt;T extends Object&gt;(validators: ValidatorMap) =&gt; (input: T): Validated&lt;T&gt; =&gt; {
  const errors: ErrorMap = {}
  let hasErrors = false
  for (const [key, value] of Object.entries(input)) {
    if (validators[key]) {
      for (const validator of validators[key]) {
        const error = validator(value)
        if (error) {
          hasErrors = true
          if (errors[key]) {
            errors[key].push(error)
          } else {
            errors[key] = [error]
          }
        }
      }
    }
  }

  return { input, errors, hasErrors }
}

export const stringValidators = {
  isString: (msg?: ErrorMessageCallback) =&gt; (input: string) =&gt; {
    if (!(typeof input == 'string')) return msg ? msg(input) : 'Not a string'
  },
  min: (n: number, msg?: ErrorMessageCallback) =&gt; (input: string) =&gt; {
    if (input.length &lt; n) return msg ? msg(input) : `Must be greater than ${n} characters in length`
  },
  max: (n: number, msg?: ErrorMessageCallback) =&gt; (input: string) =&gt; {
    if (input.length &gt; n) return msg ? msg(input) : `Must be less than ${n} characters in length`
  },
  email: (msg?: ErrorMessageCallback) =&gt; (input: string) =&gt; {
    const emailRe = /^(([^&lt;&gt;()[\]\\.,;:\s@"]+(\.[^&lt;&gt;()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
    if (!emailRe.test(input.toLowerCase())) return msg ? msg(input) : 'Not a valid email address'
  }
}
</code></pre>
            </div>

            <footer>
                <p><i>Until next time,</i></p>
                <p><i>Brian</i></p>
            </footer>
        </article>
    </main>

    <footer class="site-footer">
    <p>
        <small>Since August 4th, 2023. All words by Brian
            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>
    </p>
</footer>

</div>

<script src="/scripts/chicken-and-magpie.js"></script>
<script src="/scripts/skip-to-section.js"></script>
<script src="/scripts/code-highlighter.js"></script>
</body>
</html>
