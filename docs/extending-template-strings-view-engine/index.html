<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8"/>    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>    <!-- Meta Description -->    <meta name="description" content="Template strings as a view engine - Part 2"/>    <!-- Keywords -->    <meta name="keywords" content="Brian Douglas, blog, "/>    <!-- Author -->    <meta name="author" content="Brian Douglas"/>    <!-- Open Graph / Facebook -->    <meta property="og:type" content="website"/>    <meta property="og:title" content="BrianDouglas.ie - Template strings as a view engine - Part 2"/>    <meta property="og:description" content="Template strings as a view engine - Part 2"/>    <meta property="og:url" content="https://www.briandouglas.ie"/>    <meta property="og:image:type" content="image/png"/>    <meta property="og:image:width" content="1280"/>    <meta property="og:image:height" content="640"/>    <meta property="og:site_name" content="BrianDouglas.ie"/>    <meta property="og:image:alt" content="A preview image for the post titled 'Template strings as a view engine - Part 2'"/>    <!-- Twitter Meta -->    <meta name="twitter:card" content="summary_large_image"/>    <meta name="twitter:site" content="@BrianDouglasIE"/>    <meta name="twitter:title" content="BrianDouglas.ie - Template strings as a view engine - Part 2"/>    <meta name="twitter:description" content="Template strings as a view engine - Part 2"/>    <!-- Canonical URL -->    <link rel="canonical" href="https://www.briandouglas.ie"/>    <!-- Favicon (Optional) -->    <link rel="icon" href="https://www.briandouglas.ie/favicon.ico" type="image/x-icon"/>    <!-- Robots -->    <meta name="robots" content="index, follow"/>    <!-- Favicon-->    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>    <link rel="manifest" href="/site.webmanifest"/>    <title>Template strings as a view engine - Part 2</title>    <link rel="stylesheet" href="/styles.css"></head><body><div class="content">    <header class="site-header">    <a href="/" class="home">Brian Douglas</a>    <a href="https://github.com/BrianDouglasIE" class="github">        <svg                height="32"                aria-hidden="true"                viewBox="0 0 24 24"                width="32"                data-view-component="true"        >            <path                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"            ></path>        </svg>    </a></header>    <div class="breadcrumbs">        <a href="/">Home</a> / <span>Template strings as a view engine - Part 2</span>    </div>    <main>        <article class="post">            <header>                <h1>Template strings as a view engine - Part 2</h1>                <time datetime="20/08/2025">20/08/2025</time>            </header>            <div class="body">                <p>I've been thinking some more about using template strings as a view engine. This blog for
example now uses the template engine shown below. It's quite simple to implement and it's
usage in html files is super intuitive. You just need to remember that the html you are
writing will be intepretted as a template string, and you already know how to use template
strings, so there is no overhead.</p>
<p>I've expanded on my last post to make it a more full featured engine. The below code adds
helper methods that can be called inside a template. For example, to include one template
in another you can use the <code>helper.include()</code> method. Which essentially allows you to use
partials and layouts.</p>
<p>It's possible to pass in any var name to use in the template. But I have settled on <code>data</code>
as a single object to hold all the relevant view <em>data</em>. This reduces cognitive load, as I
know each template has access to <code>data</code> and <code>helpers</code>.</p>
<p>The implementation below reads all the html files inside the <em>viewDir</em> folder and registers
them as <em>views</em>. The same is true for all the html files in the <em>includesDir</em> folder. This
Means that the <code>helpers.include()</code> method can pull in any template from the includes dir.
Likewise <code>view</code> will render any file from the <code>viewDir</code>.</p>
<p>Implementation and example usage below.</p>
<h2>Usage</h2>
<pre><code class="language-html">&lt;!-- index.html --&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;${ data.title ?? 'default title'}&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h2&gt;Post List&lt;/h2&gt;
        ${helpers.include('post-list', { posts })}
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-html">&lt;!-- includes/post-list.html --&gt;
&lt;ul&gt;
    ${data.posts.map(post =&gt; `
        &lt;li&gt;${post.title}&lt;/li&gt;
    `).join('')}
&lt;/ul&gt;
</code></pre>
<h2>Implementation</h2>
<pre><code class="language-javascript">import {readFile} from 'node:fs/promises'
import {existsSync} from 'node:fs'
import {join} from 'node:path'

const outDir = './docs'
const viewDir = './views'
const includeDir = join(viewDir, './includes')

/*
 * View engine
 */

const views = {}
const includes = {}

const templateHelpers = {
    include: (name, data) =&gt; includes[name](data),
    // add methods here to make them available in templates
}

function compileTemplate(template, ...varNames) {
    const fn = new Function('helpers', ...varNames, `return \`${template}\``)
    return (...args) =&gt; fn(templateHelpers, ...args)
}

for (const entry of await readdir(includeDir)) {
    if (!entry.endsWith('.html')) continue

    includes[entry.replace('.html', '')] = compileTemplate(await readFile(join(includeDir, entry)), 'data')
}

for (const entry of await readdir(viewDir)) {
    if (!entry.endsWith('.html')) continue

    views[entry.replace('.html', '')] = compileTemplate(await readFile(join(viewDir, entry), 'utf8'), 'data')
}

function view(name, data) {
    return views[name](data)
}
</code></pre>
            </div>            <footer>                <p><i>Until next time,</i></p>                <p><i>Brian</i></p>            </footer>        </article>    </main>    <footer class="site-footer">    <p>        <small>Since August 4th, 2023. All words by Brian            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>    </p></footer></div><script src="/scripts/chicken-and-magpie.js"></script><script src="/scripts/skip-to-section.js"></script><script src="/scripts/code-highlighter.js"></script></body></html>